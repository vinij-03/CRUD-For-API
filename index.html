<!DOCTYPE html>
<html>

<head>
  <title> API-CRUD </title>
  <style>
    form {
      display: flex;
      flex-direction: column;
      margin-bottom: 10px;
    }

    input[type="text"],   
    textarea {
      margin-bottom: 10px;
      padding: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    button[type="button"] {
      padding: 5px 10px;
      border-radius: 5px;
      border: none;
      background-color: #008cba;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
    }

    button[type="button"]:hover {
      background-color: #006e9f;
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    th,
    td {
      text-align: left;
      padding: 8px;
    }

    tr:nth-child(even) {
      background-color: #f2f2f2;
    }

    th {
      background-color: #4CAF50;
      color: white;
    }
  </style>
</head>

<body>
  <h1>
    <center>API CRUD </center>
  </h1>
  <hr />
 
  <button onclick="getAllNotes()">Get All Notes</button>

  <!-- form to add a new note -->
  <form>
    <input type="text" id="title" placeholder="Title" />
    <textarea id="content" placeholder="Content"></textarea>
    <button type="button" onclick="addNote()">Add Note</button>
  </form>

  <!-- table to display notes -->
  <table id="notes-table">
    <thead>
      <tr>
        <th>Title</th>
        <th>Content</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="notes-table-body">
    </tbody>
  </table>

  <script>
    // Function to add a note row to the table
    function addNoteRow(id, title, content) {
      // Create table row and cells
      let row = document.createElement("tr");
      let titleCell = document.createElement("td");
      let contentCell = document.createElement("td");
      let actionsCell = document.createElement("td");

      // Add data to cells
      titleCell.textContent = title;
      contentCell.textContent = content;

      // Add buttons to actions cell
      let updateButton = document.createElement("button");
      updateButton.textContent = "Update";
      updateButton.onclick = function () {
        // Set update form values
        document.getElementById("id").value = id;
        document.getElementById("title").value = title;
        document.getElementById("content").value = content;
      };
      actionsCell.appendChild(updateButton);

      let deleteButton = document.createElement("button");
      deleteButton.textContent = "Delete";
      deleteButton.onclick = function () {
        deleteNote(id);
      };
      actionsCell.appendChild(deleteButton);

      // Add cells to row and row to table body
      row.appendChild(titleCell);
      row.appendChild(contentCell);
      row.appendChild(actionsCell);
      document.getElementById("notes-table-body").appendChild(row);
    }

    // Function to clear the notes table
    function clearNotesTable() {
      document.getElementById("notes-table-body").innerHTML = "";
    }

    // Function to get all notes and display them in the table
    function getAllNotes() {
      fetch("/notes/all")
        .then(response => response.json())
        .then(data => {
          clearNotesTable();
          data.forEach(note => {
            addNoteRow(note.id, note.title, note.content);
          });
        });
    }

    // Function to add a note
    function addNote() {
      let title = document.getElementById("title").value;
      let content = document.getElementById("content").value;
      fetch("https://jsonplaceholder.typicode.com/posts", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ title: title, content: content })
      })
        .then(response => response.json())
        .then(data => {
          // Add note row to table and clear form
          addNoteRow(data.id, data.title, data.content);
          document.getElementById("title").value = "";
          document.getElementById("content").value = "";
        });
    }

    // Function to update a note
    function updateNote() {
      let id = document.getElementById("id").value;
      let title = document.getElementById("title").value;
      let content = document.getElementById("content").value;
      fetch(`/notes/${id}`, {
        method: "PATCH",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ title: title, content: content })

      })
    }
  </script>
</body>

</html>
